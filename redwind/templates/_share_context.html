{% from "_macros.html" import author_image %}
{% for share in post.share_contexts %}
  <div class="share-context">

    {% if not share.author_name and share.permalink %}
      <i class="fa fa-retweet"></i> Shared
      <a class="u-repost-of" href="{{ share.permalink }}">
        {% if share.title %}
          {{share.title}}
        {% else %}
          {{ share.permalink | prettify_url }}
        {% endif %}
      </a>
    {% else %}
      <div class="p-repost-of h-cite">

        <i class="fa fa-retweet"></i> Shared a post by
        <span class="p-author h-card">
          {{ author_image(share.author_image, share.author_name) }}

          {% if share.author_name and share.author_url %}
            <a class="p-name u-url" href="{{share.author_url}}">{{ share.author_name }}</a>
          {% elif share.author_name %}
            <span class="p-name">{{ share.author_name}}</span>
          {% elif share.author_url %}
            <a class="u-url" href="{{share.author_url}}">{{ share.author_url | prettify_url }}</a>
          {% endif %}
        </span>

        from
        <time class="dt-published" datetime="{{ share.pub_date | isotime }}"><a class="u-url" href="{{ share.permalink }}">{{ share.pub_date | human_time }}</a></time>

        <div class="content">
          {% if share.title %}
            <span class="p-name">{{share.title}}</span>
          {% endif %}

          <div class="e-content">
            {% set content_words = share.content | format_as_text | wordcount %}
            {% if content_words < 200 %}
              {{ share.content | bleach | safe }}
            {% else %}
              {{ share.content | format_as_text | truncate(200) }}
              <a class="u-url" href="{{ share.permalink }}">continued</a>
            {% endif %}
          </div>
        </div>


        <div style="clear: both"></div>

      </div>
    {% endif %}
  </div>
{% endfor %}
